<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–∞</title>
		<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Bootstrap -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet" />
		<link rel="stylesheet" href="/static/style.css" />
		<script>
			function addServiceRow() {
				const table = document.getElementById("services");
				const newRow = table.insertRow(-1);
				const cols = [
					"service_date",
					"car_number",
					"service_name",
					"quantity",
					"price",
					"total",
				];
				cols.forEach((col, idx) => {
					let cell = newRow.insertCell(idx);
					let input = document.createElement("input");
					input.name = col;
					input.type =
						col === "quantity" || col === "price" ? "number" : "text";
					input.className = "form-control";
					input.required = true;
					if (col === "total") {
						input.readOnly = true;
						input.className += " bg-light";
					}
					input.oninput = () => calculateTotal(newRow);
					cell.appendChild(input);
				});
				const removeCell = newRow.insertCell(cols.length);
				const removeBtn = document.createElement("button");
				removeBtn.textContent = "üóëÔ∏è";
				removeBtn.className = "btn btn-danger";
				removeBtn.type = "button";
				removeBtn.onclick = () => table.deleteRow(newRow.rowIndex);
				removeCell.appendChild(removeBtn);
			}

			function calculateTotal(row) {
				const quantity = row.cells[3].querySelector("input").value;
				const price = row.cells[4].querySelector("input").value;
				const totalCell = row.cells[5].querySelector("input");
				totalCell.value =
					quantity && price ? (quantity * price).toFixed(2) : "";

				calculateGrandTotal();
			}

			function calculateGrandTotal() {
				const table = document.getElementById("services");
				let grandTotal = 0;
				for (let i = 1; i < table.rows.length; i++) {
					const total =
						parseFloat(table.rows[i].cells[5].querySelector("input").value) ||
						0;
					grandTotal += total;
				}
				document.getElementById("grandTotal").textContent =
					grandTotal.toFixed(2) + " ‚ÇΩ";
			}

			form.onsubmit = () => {
				console.log("–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:", new FormData(form)); // –õ–æ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
			};
		</script>
	</head>
	<body class="bg-light">
		<div class="container mt-4">
			<div class="card shadow-sm">
				<div class="card-header bg-primary text-white">
					<h3 class="mb-0">üîß –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Ç–∞ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö</h3>
				</div>
				<div class="card-body">
					<form action="/generate" method="post">
						<!-- –ù–æ–º–µ—Ä –∏ –¥–∞—Ç–∞ –∞–∫—Ç–∞ -->
						<div class="mb-3">
							<label class="form-label">–ù–æ–º–µ—Ä –∞–∫—Ç–∞</label>
							<input
								type="text"
								name="act_number"
								class="form-control"
								required />
						</div>

						<div class="mb-3">
							<label class="form-label">–î–∞—Ç–∞ –∞–∫—Ç–∞</label>
							<input
								type="date"
								name="act_date"
								class="form-control"
								required />
						</div>

						<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑—á–∏–∫–µ -->
						<div class="mb-3">
							<h5 class="text-primary">üßæ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑—á–∏–∫–µ</h5>
						</div>

						<div class="mb-3">
							<label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</label>
							<input
								type="text"
								name="client_name"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–ê–¥—Ä–µ—Å –∑–∞–∫–∞–∑—á–∏–∫–∞</label>
							<input
								type="text"
								name="client_address"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω –∑–∞–∫–∞–∑—á–∏–∫–∞</label>
							<input
								type="tel"
								name="client_phone"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">Email –∑–∞–∫–∞–∑—á–∏–∫–∞</label>
							<input
								type="email"
								name="client_email"
								class="form-control"
								required />
						</div>

						<!-- –ü–æ–¥–ø–∏—Å—å –∑–∞–∫–∞–∑—á–∏–∫–∞ -->
						<div class="mb-3">
							<label class="form-label">–ü–æ–¥–ø–∏—Å—å –∑–∞–∫–∞–∑—á–∏–∫–∞</label>
							<input
								type="text"
								name="client_signature"
								class="form-control"
								required />
						</div>

						<!-- –î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
						<div class="mb-3">
							<h5 class="text-primary">üßë‚Äçüîß –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ</h5>
						</div>

						<div class="mb-3">
							<label class="form-label">–§–ò–û –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</label>
							<input
								type="text"
								name="executor_name"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–ê–¥—Ä–µ—Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</label>
							<input
								type="text"
								name="executor_address"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</label>
							<input
								type="tel"
								name="executor_phone"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">Email –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</label>
							<input
								type="email"
								name="executor_email"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–ü–æ–¥–ø–∏—Å—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</label>
							<input
								type="text"
								name="executor_signature"
								class="form-control"
								required />
						</div>

						<!-- –û—Å–Ω–æ–≤–∞–Ω–∏–µ -->
						<div class="mb-3">
							<h5 class="text-primary">üìÑ –û—Å–Ω–æ–≤–∞–Ω–∏–µ</h5>
						</div>

						<div class="mb-3">
							<label class="form-label">–ù–æ–º–µ—Ä —Å—á—ë—Ç–∞</label>
							<input
								type="text"
								name="invoice_number"
								class="form-control"
								required />
						</div>
						<div class="mb-3">
							<label class="form-label">–î–∞—Ç–∞ —Å—á—ë—Ç–∞</label>
							<input
								type="date"
								name="invoice_date"
								class="form-control"
								required />
						</div>

						<!-- –£—Å–ª—É–≥–∏ -->
						<div class="mb-3">
							<h5 class="text-primary">üõ†Ô∏è –£—Å–ª—É–≥–∏</h5>
						</div>

						<table class="table table-bordered table-hover" id="services">
							<thead class="table-secondary">
								<tr>
									<th>–î–∞—Ç–∞</th>
									<th>–ì–æ—Å–Ω–æ–º–µ—Ä –¢–°</th>
									<th>–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</th>
									<th>–ö–æ–ª-–≤–æ</th>
									<th>–¶–µ–Ω–∞ (‚ÇΩ)</th>
									<th>–°—É–º–º–∞ (‚ÇΩ)</th>
									<th>–£–¥–∞–ª–∏—Ç—å</th>
								</tr>
							</thead>
							<tbody></tbody>
						</table>
						<button
							type="button"
							class="btn btn-outline-primary mb-3"
							onclick="addServiceRow()">
							‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
						</button>

						<!-- –ò—Ç–æ–≥ -->
						<div class="mb-4">
							<h5>üí∞ –ò—Ç–æ–≥: <span id="grandTotal">0.00 ‚ÇΩ</span></h5>
						</div>

						<button type="submit" class="btn btn-success w-100">
							üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç
						</button>
					</form>
				</div>
			</div>
		</div>

		<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Bootstrap JS -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	</body>
</html>
